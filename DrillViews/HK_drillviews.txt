create view `dfs`.`HKDrillView`.`events` as
SELECT 
columns[0] AS watching_count, 
columns[1] AS olson_path, 
columns[2] AS calendar_count, 
columns[3] AS comment_count, 
columns[4] AS region_abbr, 
columns[5] AS postal_code, 
columns[6] AS going_count, 
columns[7] AS all_day, 
columns[8] AS latitude, 
columns[9] AS groups, 
columns[10] AS url, 
columns[11] AS id, 
columns[12] AS privacy, 
columns[13] AS city_name, 
columns[14] AS link_count, 
columns[15] AS longitude, 
columns[16] AS country_name, 
columns[17] AS country_abbr, 
columns[18] AS region_name, 
columns[19] AS start_time, 
columns[20] AS tz_id, 
columns[21] AS description, 
columns[22] AS modified, 
columns[23] AS venue_display, 
columns[24] AS tz_country, 
columns[25] AS performers_creator, 
columns[26] AS performers_linker, 
columns[27] AS performers_name, 
columns[28] AS performers_url, 
columns[29] AS performers_id, 
columns[30] AS performers_shortbio, 
columns[31] AS title, 
columns[32] AS venue_address, 
columns[33] AS geocode_type, 
columns[34] AS tz_olson_path, 
columns[35] AS recur_string, 
columns[36] AS calendars, 
columns[37] AS owner, 
columns[38] AS going, 
columns[39] AS country_abbr2, 
columns[40] AS image, 
columns[41] AS created, 
columns[42] AS venue_id, 
columns[43] AS tz_city, 
columns[44] AS stop_time, 
columns[45] AS venue_name, 
columns[46] AS venue_url FROM `dfs`.`HK`.`Events`;


create view `dfs`.`HKDrillView`.`ParkingVacancyData` as 
SELECT columns[0] as parkId,
columns[1] as pcVacancyType,
columns[2] as pcVacancyEV,
columns[3] as pcVacancyDIS,
columns[4] as pcVacancy,
columns[5] as pcCategory,
columns[6] as pcLastUpdated,
columns[7] as lgvVacancyType,
columns[8] as lgvVacancyEV,
columns[9] as lgvVacancyDIS,
columns[10] as lgvVacancy,
columns[11] as lgvCategory,
columns[12] as lgvLastUpdated,
columns[13] as hgvVacancyType,
columns[14] as hgvVacancyEV,
columns[15] as hgvVacancyDIS,
columns[16] as hgvVacancy,
columns[17] as hgvCategory,
columns[18] as hgvLastUpdated,
columns[19] as mcVacancyType,
columns[20] as mcVacancyEV,
columns[21] as mcVacancyDIS,
columns[22] as mcVacancy,
columns[23] as mcCategory,
columns[24] as mcLastUpdated
from `dfs`.`HK`.`/ParkingInfo/vacancy/ParkingInfo.txt`

CREATE VIEW `dfs`.`HKDrillView`.`ParkingInfo` as 
SELECT park_id,name,nature,carpark_Type,
t.address.streetName as streetName,t.address.buildingNo as buildingNumber,t.address.subDistrict as subDistrict,t.address.dcDistrict as dcDistrict,t.address.region as Region,
displayAddress,district,latitude,longitude,contactNo,website,opening_status,
t.openingHours[0].periodStart as openingStartHr,t.openingHours[0].periodEnd as openingEndHr,
t.facilities[0] as Facilities1,t.facilities[1] as Facilities2,t.facilities[2] as Facilities3,t.facilities[3] as Facilities4,
CASE WHEN t.privateCar.monthlyCharges[0].price IS NULL THEN 0 ELSE t.privateCar.monthlyCharges[0].price END as pcPrice,
t.privateCar.spaceUNL as pCspaceUNL,
t.privateCar.spaceEV as pCspaceEV,
t.privateCar.spaceDIS as pCspaceDIS,
t.privateCar.space as pCspace,
CASE WHEN t.LGV.monthlyCharges[0].price IS NULL THEN 0 ELSE t.LGV.monthlyCharges[0].price END as lgvPrice,
t.LGV.spaceUNL as lgvspaceUNL,
t.LGV.spaceEV as lgvspaceEV,
t.LGV.spaceDIS as lgvspaceDIS,
t.LGV.space as lgvspace,
CASE WHEN t.HGV.monthlyCharges[0].price IS NULL THEN 0 ELSE t.HGV.monthlyCharges[0].price END as hgvPrice,
t.HGV.spaceUNL as hgvspaceUNL,
t.HGV.spaceEV as hgvspaceEV,
t.HGV.spaceDIS as hgvspaceDIS,
t.HGV.space as hgvspace,
CASE WHEN t.coach.monthlyCharges[0].price IS NULL THEN 0 ELSE t.coach.monthlyCharges[0].price END as coachPrice,
t.coach.spaceUNL as caochspaceUNL,
t.coach.spaceEV as coachspaceEV,
t.coach.spaceDIS as coachspaceDIS,
t.coach.space as coachspace,
CASE WHEN t.motorCycle.monthlyCharges[0].price IS NULL THEN 0 ELSE t.motorCycle.monthlyCharges[0].price END as motorCyclePrice,
t.motorCycle.spaceUNL as mcspaceUNL,
t.motorCycle.spaceEV as mcspaceEV,
t.motorCycle.spaceDIS as mcspaceDIS,
t.motorCycle.space as mcspace,
t.publishedDate
from `dfs`.`default`.`/HongKong/ParkingInfo/parkingjson.json` t